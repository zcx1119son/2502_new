<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.foursquare.nextrozi.login.dao.LoginDAO">

    <resultMap id="companyLoginResult" type="com.foursquare.nextrozi.login.vo.LoginVO">
        <result property="company_email" column="COMPANY_EMAIL"/>
        <result property="company_pwd" column="COMPANY_PWD"/>
        <result property="companyCode" column="COMPANY_CODE"/>
        <result property="companyName" column="COMPANY_NAME"/>
        <result property="company_ownername" column="COMPANY_OWNERNAME"/>
    </resultMap>

    <resultMap id="memberLoginResult" type="com.foursquare.nextrozi.login.vo.LoginVO">
        <result property="member_id" column="MEMBER_ID"/>
        <result property="member_email" column="MEMBER_EMAIL"/>
        <result property="member_pwd" column="MEMBER_PWD"/>
        <result property="member_name" column="MEMBER_NAME"/>
        <result property="companyCode" column="COMPANY_CODE"/>
    </resultMap>

    <resultMap id="masterLoginResult" type="com.foursquare.nextrozi.login.vo.LoginVO">
        <result property="master_id" column="MASTER_ID"/>
        <result property="master_pwd" column="MASTER_PWD"/>
    </resultMap>

    <select id="checkCompanyLogin" parameterType="com.foursquare.nextrozi.login.vo.LoginVO" resultMap="companyLoginResult">
        SELECT
        COMPANY_EMAIL,
        COMPANY_PWD,
        COMPANY_CODE,
        COMPANY_NAME,
        COMPANY_OWNERNAME
        FROM
        TB_COMPANY
<!--        WHERE-->
<!--        COMPANY_EMAIL = #{email} AND COMPANY_PWD = #{password} AND STATUS = '승인'-->
    </select>

    <select id="checkMemberLogin" parameterType="com.foursquare.nextrozi.login.vo.LoginVO" resultMap="memberLoginResult">
        SELECT
        MEMBER_ID,
        MEMBER_EMAIL,
        MEMBER_PWD,
        MEMBER_NAME,
        COMPANY_CODE
        FROM
        TB_MEMBER
        WHERE
        MEMBER_EMAIL = #{email} AND MEMBER_PWD = #{password} AND COMPANY_CODE = #{companyCode}
    </select>

    <select id="checkMasterLogin" parameterType="com.foursquare.nextrozi.login.vo.LoginVO" resultMap="masterLoginResult">
        SELECT
        MASTER_ID,
        MASTER_PWD
        FROM
        TB_MASTER
        WHERE
        MASTER_ID = #{email} AND MASTER_PWD = #{password}
    </select>

    <insert id="insertCompany" parameterType="com.foursquare.nextrozi.login.vo.LoginVO">
        INSERT INTO TB_COMPANY (
        COMPANY_CODE,
        COMPANY_NAME,
        COMPANY_EMAIL,
        COMPANY_PWD,
        COMPANY_OWNERNAME,
        COMPANY_PHONE,
        CREATED_DATE,
        STATUS
        ) VALUES (
        #{companyCode},
        #{companyName},
        #{email},
        #{password},
        #{companyOwnerName},
        #{phone},
        SYSDATE,
        '요청'
        )
    </insert>

</mapper>