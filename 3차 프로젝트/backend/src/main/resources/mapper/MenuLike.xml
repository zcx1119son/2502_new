<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="fs.human.yabab.RestaurantReview.dao.MenuLikeDAO">

    <select id="getMenuLikeCount" parameterType="long" resultType="int">
        SELECT COUNT(LIKE_ID)
        FROM C##FINAL.TB_MENU_LIKE
        WHERE MENU_ID = #{menuId}
    </select>

    <select id="isMenuLikedByUser" resultType="int">
        SELECT COUNT(LIKE_ID)
        FROM C##FINAL.TB_MENU_LIKE
        WHERE MENU_ID = #{menuId}
        AND USER_ID = #{userId}
    </select>

    <insert id="insertMenuLike" parameterType="fs.human.yabab.RestaurantReview.vo.MenuLikeRequestDTO">
        INSERT INTO C##FINAL.TB_MENU_LIKE (
        LIKE_ID,
        MENU_ID,
        USER_ID,
        CREATED_DATE
        ) VALUES (
        C##FINAL.SEQ_MENU_LIKE_ID.NEXTVAL, -- 시퀀스를 사용하여 LIKE_ID 자동 생성
        #{menuId},
        #{userId},
        SYSDATE
        )
    </insert>

    <delete id="deleteMenuLike" parameterType="fs.human.yabab.RestaurantReview.vo.MenuLikeRequestDTO">
        DELETE FROM C##FINAL.TB_MENU_LIKE
        WHERE MENU_ID = #{menuId}
        AND USER_ID = #{userId}
    </delete>

</mapper>
